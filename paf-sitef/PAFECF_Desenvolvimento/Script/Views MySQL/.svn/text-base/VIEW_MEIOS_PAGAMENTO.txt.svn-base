	CREATE
	VIEW t2tipafecf.VIEW_MEIOS_PAGAMENTO
	AS

	SELECT 
	V.DATA_VENDA as DATA_ACUMULADO, 
		M.ID_ECF_IMPRESSORA, 
		P.DESCRICAO AS DESCRICAO, 
		SUM(TP.VALOR) AS TOTAL 
	FROM 
		ECF_VENDA_CABECALHO V, ECF_MOVIMENTO M, ECF_TIPO_PAGAMENTO P, ECF_TOTAL_TIPO_PGTO TP 
	WHERE 
		V.ID_ECF_MOVIMENTO = M.ID AND 
		TP.ID_ECF_VENDA_CABECALHO=V.ID AND 
		TP.ID_ECF_TIPO_PAGAMENTO = P.ID
	GROUP BY 
		P.DESCRICAO,DATA_ACUMULADO,M.ID_ECF_IMPRESSORA 

	UNION 

	SELECT 
		S.DATA_SUPRIMENTO AS DATA_ACUMULADO, 
		M.ID_ECF_IMPRESSORA, 
		"SUPRIMENTO" AS DESCRICAO, 
		SUM(S.VALOR) AS TOTAL 
	FROM 
		ECF_SUPRIMENTO S, ECF_MOVIMENTO M 
	WHERE 
		S.ID_ECF_MOVIMENTO = M.ID
	GROUP BY 
		DESCRICAO,DATA_ACUMULADO,M.ID_ECF_IMPRESSORA 